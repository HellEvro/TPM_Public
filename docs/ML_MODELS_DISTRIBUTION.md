# –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –û–±—É—á–µ–Ω–Ω—ã—Ö ML –ú–æ–¥–µ–ª–µ–π

## üì¶ –§–∞–π–ª—ã —Å –û–±—É—á–µ–Ω–Ω—ã–º–∏ –ú–æ–¥–µ–ª—è–º–∏

### 1. ML Risk Predictor (`data/ai/models/`)

```
data/ai/models/
‚îú‚îÄ‚îÄ risk_predictor.pkl          # –û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è SL/TP
‚îú‚îÄ‚îÄ risk_scaler.pkl              # Scaler –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ features
‚îî‚îÄ‚îÄ model_metadata.json         # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ (–≤–µ—Ä—Å–∏—è, –¥–∞—Ç–∞ –æ–±—É—á–µ–Ω–∏—è)
```

#### `risk_predictor.pkl`
- **–°–æ–¥–µ—Ä–∂–∏—Ç:** –û–±—É—á–µ–Ω–Ω–∞—è GradientBoosting –º–æ–¥–µ–ª—å
- **–ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç:** –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ SL% –∏ TP% –Ω–∞ –æ—Å–Ω–æ–≤–µ market features
- **Features:** RSI, volatility, trend strength, volume, price, stop history
- **–†–∞–∑–º–µ—Ä:** ~50-100 KB

#### `risk_scaler.pkl`
- **–°–æ–¥–µ—Ä–∂–∏—Ç:** StandardScaler –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ features
- **–ù–µ–æ–±—Ö–æ–¥–∏–º:** –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏
- **–†–∞–∑–º–µ—Ä:** ~1 KB

#### `model_metadata.json`
```json
{
  "version": "1.0",
  "trained_date": "2025-10-27T00:00:00",
  "training_samples": 150,
  "model_type": "GradientBoostingRegressor",
  "features": ["rsi", "volatility", "trend_strength", "volume", "price", "coin_stops_count", "avg_stop_duration_hours"],
  "mae_sl": 2.3,
  "mae_tp": 12.5,
  "accuracy": 0.72
}
```

---

## üéØ –ö–∞–∫ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ì–æ—Ç–æ–≤—ã–µ –ú–æ–¥–µ–ª–∏

### –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç–µ –æ–±—É—á–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –æ—Ç –ø—Ä–æ–¥–∞–≤—Ü–∞

–ü—Ä–æ–¥–∞–≤–µ—Ü –ø–µ—Ä–µ–¥–∞–µ—Ç –≤–∞–º:
- `risk_predictor.pkl` - –æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
- `risk_scaler.pkl` - –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ç–æ—Ä
- `model_metadata.json` - –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –®–∞–≥ 2: –†–∞–∑–º–µ—Å—Ç–∏—Ç–µ —Ñ–∞–π–ª—ã

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã –≤ –≤–∞—à—É —É—Å—Ç–∞–Ω–æ–≤–∫—É:

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –µ—Å–ª–∏ –Ω–µ—Ç
mkdir -p data/ai/models/

# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã
cp risk_predictor.pkl data/ai/models/
cp risk_scaler.pkl data/ai/models/
cp model_metadata.json data/ai/models/
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏—Ü–µ–Ω–∑–∏—é

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ª–∏—Ü–µ–Ω–∑–∏—è Premium –∞–∫—Ç–∏–≤–Ω–∞:

```bash
python scripts/activate_premium.py
```

### –®–∞–≥ 4: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É

```bash
python bots.py
```

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –º–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞

–í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:

```
[MLPredictor] ‚úÖ ML –º–æ–¥–µ–ª—å –≥–æ—Ç–æ–≤–∞
[MLPredictor] ‚úÖ –ú–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞
[SmartRiskManager] ü§ñ ML –º–æ–¥–µ–ª—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∞
```

---

## üîÑ –ö–∞–∫ –û–±—É—á–∏—Ç—å –°–≤–æ—é –ú–æ–¥–µ–ª—å

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ

–ú–æ–¥–µ–ª—å **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—É—á–∞–µ—Ç—Å—è** –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–∏—Ö —É—Å–ª–æ–≤–∏—è—Ö:

1. **–ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:** –ù—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 20 –∑–∞–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π —Å feedback
2. **–í—ã–∑–æ–≤ –æ–±—É—á–µ–Ω–∏—è:** –í —Ü–∏–∫–ª–µ –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤ (–∏–ª–∏ –≤—Ä—É—á–Ω—É—é)
3. **–ú–∏–Ω–∏–º—É–º –ø—Ä–∏–º–µ—Ä–æ–≤:** 20+ deals –¥–ª—è –æ–±—É—á–µ–Ω–∏—è

### –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è

```python
from bot_engine.ai.smart_risk_manager import SmartRiskManager

smart_risk = SmartRiskManager()
smart_risk.learn_from_feedback()  # –û–±—É—á–∞–µ—Ç ML –º–æ–¥–µ–ª—å
```

### –ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è

```
data/ai/training/
‚îú‚îÄ‚îÄ feedback/                    # Feedback –æ—Ç –∫–∞–∂–¥–æ–π —Å–¥–µ–ª–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ OG.json                   # –ò—Å—Ç–æ—Ä–∏—è —Å–¥–µ–ª–æ–∫ –ø–æ OG
‚îÇ   ‚îú‚îÄ‚îÄ BTC.json                  # –ò—Å—Ç–æ—Ä–∏—è —Å–¥–µ–ª–æ–∫ –ø–æ BTC
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ ml_training_data.json        # –°–æ–±—Ä–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
```

---

## üìä –ö–∞–∫ –†–∞–±–æ—Ç–∞–µ—Ç –ú–æ–¥–µ–ª—å

### –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–∏:

1. **–°–±–æ—Ä features:**
   ```python
   features = {
       'rsi': 16.7,
       'volatility': 1.2,
       'trend_strength': 0.68,
       'volume': 1000000,
       'price': 13.9387,
       'coin_stops_count': 5,
       'avg_stop_duration_hours': 12.5
   }
   ```

2. **–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ:**
   ```python
   prediction = ml_predictor.predict(features)
   # {'optimal_sl': 12.5, 'optimal_tp': 105.3, 'confidence': 0.75}
   ```

3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –ë–æ—Ç –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–º–∏ SL/TP

### –ü–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏:

1. **–û—Ü–µ–Ω–∫–∞ —Ç–æ—á–Ω–æ—Å—Ç–∏:**
   ```python
   feedback = {
       'predicted_sl': 12.5,
       'predicted_tp': 105.3,
       'actual_roi': -14.99,
       'score': 0.35  # –ü–ª–æ—Ö–æ, —Ç.–∫. -14.99 < -12.5
   }
   ```

2. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ:** Feedback —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `data/ai/training/feedback/{symbol}.json`

3. **–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ:** –ö–æ–≥–¥–∞ –Ω–∞–∫–æ–ø–∏—Ç—Å—è 20+ feedbacks ‚Üí –º–æ–¥–µ–ª—å –ø–µ—Ä–µ–æ–±—É—á–∞–µ—Ç—Å—è

---

## üîê –ó–∞—â–∏—Ç–∞ –õ–∏—Ü–µ–Ω–∑–∏–µ–π

### –ü—Ä–æ–≤–µ—Ä–∫–∏ –ª–∏—Ü–µ–Ω–∑–∏–∏:

1. **–ü—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –º–æ–¥—É–ª—è:**
   ```python
   from bot_engine.ai.ml_risk_predictor import MLRiskPredictor
   # ‚ùå –ë–µ–∑ –ª–∏—Ü–µ–Ω–∑–∏–∏: ImportError
   ```

2. **–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –º–æ–¥–µ–ª–∏:**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏—Ü–µ–Ω–∑–∏–∏ –ø—Ä–∏ `__init__`
   - –ú–æ–¥–µ–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±–µ–∑ –ª–∏—Ü–µ–Ω–∑–∏–∏

3. **–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏:**
   - –í—Å–µ –º–µ—Ç–æ–¥—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç –Ω–∞–ª–∏—á–∏–µ –ª–∏—Ü–µ–Ω–∑–∏–∏
   - –ë–µ–∑ –ª–∏—Ü–µ–Ω–∑–∏–∏ ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ

### –ö–∞–∫ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –ª–∏—Ü–µ–Ω–∑–∏–∏:

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞:
1. –°–æ–∑–¥–∞–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω–∞—è –ª–∏—Ü–µ–Ω–∑–∏—è: `python scripts/create_customer_license.py`
2. –ü–µ—Ä–µ–¥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫–∞–Ω–∞–ª
3. –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è: `python scripts/activate_premium.py`

---

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ö–∞—á–µ—Å—Ç–≤–∞ –ú–æ–¥–µ–ª–∏

### –ú–µ—Ç—Ä–∏–∫–∏ –≤ `model_metadata.json`:

- **mae_sl:** Mean Absolute Error –¥–ª—è SL (–º–µ–Ω—å—à–µ = –ª—É—á—à–µ)
- **mae_tp:** Mean Absolute Error –¥–ª—è TP (–º–µ–Ω—å—à–µ = –ª—É—á—à–µ)
- **accuracy:** –¢–æ—á–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π (0-1)
- **training_samples:** –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–º–µ—Ä–æ–≤ –≤ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–µ

### –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:

- **mae_sl < 3%** ‚Üí –û—Ç–ª–∏—á–Ω–æ
- **mae_sl < 5%** ‚Üí –•–æ—Ä–æ—à–æ
- **mae_sl > 7%** ‚Üí –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–æ–±—É—á–µ–Ω–∏–µ

- **accuracy > 0.7** ‚Üí –û—Ç–ª–∏—á–Ω–æ
- **accuracy > 0.5** ‚Üí –•–æ—Ä–æ—à–æ
- **accuracy < 0.4** ‚Üí –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–æ–±—É—á–µ–Ω–∏–µ

---

## üöÄ –ü—Ä–æ–¥–∞–∂–∞ –û–±—É—á–µ–Ω–Ω—ã—Ö –ú–æ–¥–µ–ª–µ–π

### –û–ø—Ü–∏—è 1: –ü—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏

1. –û–±—É—á–∏—Ç–µ –º–æ–¥–µ–ª—å –Ω–∞ —Å–≤–æ–∏—Ö –¥–∞–Ω–Ω—ã—Ö (–º–∏–Ω–∏–º—É–º 100+ —Å–¥–µ–ª–æ–∫)
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã `risk_predictor.pkl`, `risk_scaler.pkl`
3. –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–π—Ç–µ –≤–º–µ—Å—Ç–µ —Å Premium –ª–∏—Ü–µ–Ω–∑–∏–µ–π

### –û–ø—Ü–∏—è 2: –°–µ—Ç–µ–≤–æ–µ –æ–±—É—á–µ–Ω–∏–µ (–±—É–¥—É—â–µ–µ)

–ö–ª–∏–µ–Ω—Ç—ã –º–æ–≥—É—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É –¥–ª—è:
- –ü–æ–ª—É—á–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
- –§–µ–¥–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è (–±–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö)
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### –û–ø—Ü–∏—è 3: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–ª–∞–∫–æ (–±—É–¥—É—â–µ–µ)

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –í—ã–≥—Ä—É–∂–∞–µ—Ç –º–æ–¥–µ–ª—å –Ω–∞ –≤–∞—à —Å–µ—Ä–≤–µ—Ä
- –û–±–Ω–æ–≤–ª—è–µ—Ç –º–æ–¥–µ–ª—å –ø–æ –º–µ—Ä–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è –≤—Å–µ–º –∫–ª–∏–µ–Ω—Ç–∞–º

---

## üìù Checklist –¥–ª—è –î–∏—Å—Ç—Ä–∏–±—É—Ü–∏–∏

- [ ] –û–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å –º–∏–Ω–∏–º—É–º –Ω–∞ 100+ —Å–¥–µ–ª–∫–∞—Ö
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (`model_metadata.json`)
- [ ] –£–ø–∞–∫–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã:
  - `risk_predictor.pkl`
  - `risk_scaler.pkl`
  - `model_metadata.json`
- [ ] –°–æ–∑–¥–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—É—é –ª–∏—Ü–µ–Ω–∑–∏—é –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞
- [ ] –ü–µ—Ä–µ–¥–∞—Ç—å —Ñ–∞–π–ª—ã —á–µ—Ä–µ–∑ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∫–∞–Ω–∞–ª
- [ ] –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ

---

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ú–æ–¥–µ–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏—Ü–µ–Ω–∑–∏—é
python scripts/check_license.py

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π–ª—ã
ls -lh data/ai/models/

# –õ–æ–≥–∏ –∑–∞–≥—Ä—É–∑–∫–∏
grep "MLPredictor" logs/bots.log
```

### –ü–ª–æ—Ö–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ feedback –¥–∞–Ω–Ω—ã—Ö: `ls data/ai/training/feedback/`
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ: `smart_risk.learn_from_feedback()`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–µ—Ç—Ä–∏–∫–∏: `cat data/ai/models/model_metadata.json`

### –û—à–∏–±–∫–∞ "Not enough training data":

–ù—É–∂–Ω–æ –Ω–∞–∫–æ–ø–∏—Ç—å –º–∏–Ω–∏–º—É–º 20 feedback –∑–∞–ø–∏—Å–µ–π. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–∑–∏—Ü–∏–π –∏ –¥–æ–∂–¥–∏—Ç–µ—Å—å –∏—Ö –∑–∞–∫—Ä—ã—Ç–∏—è.


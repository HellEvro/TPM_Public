# –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ª–æ–≥–∏–∫–∏, –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ InfoBot

–û—Ç—á—ë—Ç –æ –ø–µ—Ä–µ–∫—Ä—ë—Å—Ç–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤, –∫–æ–Ω—Ñ–∏–≥–∞, –ª–æ–≥–æ–≤ –∏ –ë–î.

---

## 1. –ú–∞—Ç—Ä–∏—Ü–∞ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –≤—Ö–æ–¥–∞

| –ö–æ–Ω—Ñ–∏–≥ | full_ai_control | ai_enabled | AI –º–æ–¥—É–ª–∏ | AI –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ filters | –ò—Å—Ç–æ—á–Ω–∏–∫ —Ä–µ—à–µ–Ω–∏—è | ai_decision_id | –°–∞–º–æ–æ–±—É—á–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ |
|--------|-----------------|------------|-----------|------------------------|------------------|----------------|---------------------------|
| –¢–æ–ª—å–∫–æ —Å–∫—Ä–∏–ø—Ç | ‚ùå | ‚ùå | ‚ùå | –ù–µ—Ç | SCRIPT | ‚Äî | ‚Äî |
| AI —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã–π | ‚ùå | ‚úÖ | ‚úÖ | should_open_position_with_ai | AI/SCRIPT | –î–∞ (–µ—Å–ª–∏ AI) | update_ai_decision_result |
| FullAI | ‚úÖ | ‚Äî | ‚úÖ | get_ai_entry_decision | AI | **–ù–µ—Ç** | process_trade_for_self_learning (—á–µ—Ä–µ–∑ –≤–µ—Ç–∫—É decision_source==AI) |
| FullAI Adaptive (virtual) | ‚úÖ | ‚Äî | ‚úÖ | get_ai_entry_decision | AI | –ù–µ—Ç | ‚Äî (–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ ‚Äî –≤ fullai_adaptive) |

**–ö–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç:** –ü—Ä–∏ FullAI `get_ai_entry_decision` –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `ai_decision_id`, –Ω–æ `_last_decision_source='AI'` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è. –°–∞–º–æ–æ–±—É—á–µ–Ω–∏–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ `_log_position_closed` –ø—Ä–∏ `decision_source == 'AI'`.

---

## 2. –ú–∞—Ç—Ä–∏—Ü–∞ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∑–∞–∫—Ä—ã—Ç–∏—è

| –ö—Ç–æ –æ–±–Ω–∞—Ä—É–∂–∏–ª –∑–∞–∫—Ä—ã—Ç–∏–µ | already_closed_trade | effective_reason –∏–∑ bots_db | –î–µ–π—Å—Ç–≤–∏—è |
|------------------------|----------------------|-----------------------------|----------|
| **–ë–æ—Ç** (_close_position_on_exchange) | ‚Äî | ‚Äî | _log_position_closed ‚Üí bot_history, bots_db, record_real_close, process_trade_for_self_learning |
| **Sync** (–ø–æ–∑–∏—Ü–∏—è –∏—Å—á–µ–∑–ª–∞) | False | CLOSED_ON_EXCHANGE | history_log_position_closed, save bots_db, record_real_close |
| **Sync** (–ø–æ–∑–∏—Ü–∏—è –∏—Å—á–µ–∑–ª–∞) | False | RSI_EXIT/BOT_LIMIT_TP/SL (–Ω–∞–π–¥–µ–Ω–æ –≤ bots_db) | –ü—Ä–æ–ø—É—Å–∫ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤: –Ω–µ –ª–æ–≥–∏—Ä—É–µ–º, –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º, –Ω–µ record_real_close |
| **Sync** (–ø–æ–∑–∏—Ü–∏—è –∏—Å—á–µ–∑–ª–∞) | True | ‚Äî | –¢–æ–ª—å–∫–æ —É–¥–∞–ª–µ–Ω–∏–µ –±–æ—Ç–∞ –∏–∑ –ø–∞–º—è—Ç–∏ |

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤:** `_check_if_trade_already_closed` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–∫–Ω–æ 10 –º–∏–Ω—É—Ç (`from_ts_sec`/`to_ts_sec`). –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç `entry_price` (—Å—Ç—Ä–æ–≥–æ Œî < 0.0001) –∏ `entry_timestamp` (¬±2 –º–∏–Ω). **Fallback:** –ø—Ä–∏ `timestamp_match` –∏ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–∏ entry_price –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 1% ‚Äî —Å—á–∏—Ç–∞–µ—Ç—Å—è –¥—É–±–ª–∏–∫–∞—Ç–æ–º (—É—á—ë—Ç –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è).

**–ó–∞–ø—Ä–æ—Å effective_reason:** –û–∫–Ω–æ 5 –º–∏–Ω—É—Ç –Ω–∞–∑–∞–¥. –ü—Ä–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –≥–æ–Ω–∫—É sync/–±–æ—Ç.

---

## 3. –ü–æ—Ç–æ–∫–∏ –∑–∞–ø–∏—Å–∏ –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

```
–ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏
    ‚îÇ
    ‚îú‚îÄ‚ñ∫ bot_history_manager.log_position_closed  ‚Üí  bot_history.json, ai_data.db (ai_db)
    ‚îú‚îÄ‚ñ∫ bots_db.save_bot_trade_history           ‚Üí  bots_data.db (bot_trades_history)
    ‚îú‚îÄ‚ñ∫ record_real_close                        ‚Üí  fullai_analytics (fullai_events)
    ‚îî‚îÄ‚ñ∫ process_trade_for_self_learning          ‚Üí  ai_self_learning (online_learning_buffer, state)
```

**–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –≤—ã–∑–æ–≤–∞:**
- **bot_class._log_position_closed** ‚Äî –∫–æ–≥–¥–∞ –±–æ—Ç —Å–∞–º –∑–∞–∫—Ä—ã–ª
- **sync_and_cache** ‚Äî –∫–æ–≥–¥–∞ sync –æ–±–Ω–∞—Ä—É–∂–∏–ª –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏
- **api_endpoints** ‚Äî –ø—Ä–∏ —Ä—É—á–Ω–æ–º –∑–∞–∫—Ä—ã—Ç–∏–∏ —á–µ—Ä–µ–∑ UI (MANUAL_CLOSE_UI)

---

## 4. –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ —Ä–∏—Å–∫–∏ –∏ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è

### 4.1. virtual_only –≤ filters ‚Äî –≤–æ–∑–º–æ–∂–Ω—ã–π –±–∞–≥ ‚úÖ

**–°–∏—Ç—É–∞—Ü–∏—è:** –ü—Ä–∏ FullAI Adaptive, –µ—Å–ª–∏ AI –¥–∞—ë—Ç WAIT, —Å—Ç–∞–≤–∏—Ç—Å—è `last_ai_result['virtual_only'] = True` –∏ –º–æ–Ω–µ—Ç–∞ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ `potential_coins`.

**–ë—ã–ª–æ:** –†–∏—Å–∫ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ –≤–º–µ—Å—Ç–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** –í `process_auto_bot_signals` –ø–µ—Ä–µ–¥ `create_new_bot` –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞: –ø—Ä–∏ `virtual_only` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `record_virtual_open`, –∑–∞—Ç–µ–º `continue` ‚Äî `enter_position` –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è.

### 4.2. –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –±—ã—Å—Ç—Ä–æ–º sync ‚úÖ

**–°—Ü–µ–Ω–∞—Ä–∏–π:** –ë–æ—Ç –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ bots_db. Sync –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∏ –µ—â—ë –Ω–µ –≤–∏–¥–∏—Ç –∑–∞–ø–∏—Å—å (–∑–∞–¥–µ—Ä–∂–∫–∞, –¥—Ä—É–≥–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è).

**–°–º—è–≥—á–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:** `_check_if_trade_already_closed` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `from_ts_sec`/`to_ts_sec` (–æ–∫–Ω–æ 10 –º–∏–Ω—É—Ç) ‚Äî –≤–∏–¥–∏—Ç –Ω–µ–¥–∞–≤–Ω–∏–µ —Å–¥–µ–ª–∫–∏. –û–∫–Ω–æ effective_reason ‚Äî 5 –º–∏–Ω—É—Ç. –†–∏—Å–∫ –¥–≤–æ–π–Ω–æ–π –∑–∞–ø–∏—Å–∏ —Å–Ω–∏–∂–µ–Ω, –Ω–æ –ø—Ä–∏ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–µ –ë–î —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –≤–æ–∑–º–æ–∂–µ–Ω.

### 4.3. –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ entry_price –∏ entry_timestamp ‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:** `_check_if_trade_already_closed` —Ç—Ä–µ–±—É–µ—Ç `price_match` (Œî < 0.0001) –∏ `timestamp_match` (¬±2 –º–∏–Ω). –ü—Ä–∏ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–∏ –∏–ª–∏ —Ä–∞–∑–Ω–∏—Ü–µ –≤–æ –≤—Ä–µ–º–µ–Ω–∏ –≤—Ö–æ–¥–∞ –≤–æ–∑–º–æ–∂–Ω—ã –ª–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è –∏–ª–∏ –ø—Ä–æ–ø—É—Å–∫–∏ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤.

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:** Fallback: –ø—Ä–∏ `timestamp_match` –∏ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–∏ entry_price –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 1% ‚Äî —Å—á–∏—Ç–∞—Ç—å –¥—É–±–ª–∏–∫–∞—Ç–æ–º (—É—á—ë—Ç –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è).

### 4.4. –ò—Å—Ç–æ—á–Ω–∏–∫–∏ decision_source ‚úÖ

- **bot_class:** `_last_decision_source` –∏–∑ `_set_decision_source`
- **NewTradingBot.to_dict():** –≤–∫–ª—é—á–∞–µ—Ç `decision_source` ‚Äî sync –ø–æ–ª—É—á–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ bot_data
- **fullai_analytics:** –ù–µ —Ö—Ä–∞–Ω–∏—Ç decision_source –Ω–∞–ø—Ä—è–º—É—é; —Ä–µ–∞–ª—å–Ω—ã–π/–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π ‚Äî —á–µ—Ä–µ–∑ event_type

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:** `decision_source` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `bot_data` —á–µ—Ä–µ–∑ `NewTradingBot.to_dict()` –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –±–æ—Ç–∞.

---

## 5. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ñ–∏–≥—É –∏ –æ—Ç—á—ë—Ç–∞–º

### 5.1. fullai_config.json

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –í–ª–∏—è–Ω–∏–µ | –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –∫–æ–¥–µ |
|----------|---------|-----------------|
| fullai_adaptive_enabled | –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –æ–±–∫–∞—Ç–∫–∞ | is_adaptive_enabled() |
| fullai_adaptive_virtual_success_count | –£—Å–ø–µ—à–Ω—ã—Ö –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö ‚Üí 1 —Ä–µ–∞–ª—å–Ω–∞—è | get_next_action, _reset_to_virtual |
| take_profit_percent, max_loss_percent | TP/SL, close_source | sync: —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ exit_price —Å bot_tp/bot_sl |
| ai_min_confidence | –ü–æ—Ä–æ–≥ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è | get_ai_entry_decision |
| ai_override_original | AI –±–ª–æ–∫–∏—Ä—É–µ—Ç vs —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã–π | filters: ai_override |

### 5.2. FullAI Analytics (fullai_events)

- **real_open / virtual_open** ‚Äî –∏–∑ bot_class –∏ fullai_adaptive
- **real_close / virtual_close** ‚Äî –∏–∑ record_real_close, fullai_adaptive
- **blocked / refused** ‚Äî –∏–∑ bot_class –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞—Ö

**–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ:** –°–æ–±—ã—Ç–∏—è –æ—Ç—Ä–∞–∂–∞—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è. –ü—Ä–∏ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–µ sync/–±–æ—Ç –≤–æ–∑–º–æ–∂–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–ª–∏ –ø—Ä–æ–ø—É—Å–∫ real_close.

### 5.3. Self-learning (ai_self_learning)

- **–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** –î–∞–Ω–Ω—ã–µ —à–ª–∏ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ `ai_decision_id` (—Å—Ç–∞—Ä—ã–π –ø—É—Ç—å —Å should_open_position_with_ai)
- **–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** FullAI-—Å–¥–µ–ª–∫–∏ —Å `decision_source == 'AI'` —Ç–æ–∂–µ –∏–¥—É—Ç –≤ `process_trade_for_self_learning`

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –í –ª–æ–≥–∞—Ö –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ FullAI-—Å–¥–µ–ª–∫–∏ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏–π –∏–∑ `process_trade_for_self_learning`.

---

## 6. –û—Ü–µ–Ω–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### 6.1. –ü–ª—é—Å—ã —Ç–µ–∫—É—â–µ–π –ª–æ–≥–∏–∫–∏

1. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ: FullAI ‚Äî `get_ai_entry_decision`, –Ω–µ-FullAI ‚Äî `should_open_position_with_ai`
2. –£—á—ë—Ç –ø—Ä–∏—á–∏–Ω—ã –∑–∞–∫—Ä—ã—Ç–∏—è: sync –±–µ—Ä—ë—Ç effective_reason –∏–∑ bots_db
3. –°–∞–º–æ–æ–±—É—á–µ–Ω–∏–µ –ø–æ–ª—É—á–∞–µ—Ç FullAI-—Å–¥–µ–ª–∫–∏ —á–µ—Ä–µ–∑ –≤–µ—Ç–∫—É decision_source
4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —á–µ—Ä–µ–∑ `_check_if_trade_already_closed`
5. transformer_predictor –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ AI_USE_TRANSFORMER

### 6.2. –£—è–∑–≤–∏–º—ã–µ –º–µ—Å—Ç–∞ (–∞–∫—Ç—É–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)

1. ~~virtual_only –≤ filters~~ ‚Äî **–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞
2. **–ì–æ–Ω–∫–∞ sync/–±–æ—Ç** ‚Äî —Å–º—è–≥—á–µ–Ω–æ (from_ts 10 –º–∏–Ω, fallback 1%), –ø—Ä–∏ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–µ –ë–î —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –≤–æ–∑–º–æ–∂–Ω—ã –¥–≤–æ–π–Ω—ã–µ –∑–∞–ø–∏—Å–∏
3. ~~–ù–µ—Ç from_ts –≤ _check_if_trade_already_closed~~ ‚Äî **–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** –¥–æ–±–∞–≤–ª–µ–Ω —Ñ–∏–ª—å—Ç—Ä 10 –º–∏–Ω—É—Ç
4. ~~decision_source –≤ sync~~ ‚Äî **–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:** —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ to_dict()

---

## 7. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç ‚úÖ
1. **virtual_only:** –í `process_auto_bot_signals` –ø—Ä–∏ `virtual_only` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `record_virtual_open` –∏ `continue` ‚Äî `enter_position` –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è.
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤:** –í `_check_if_trade_already_closed` –¥–æ–±–∞–≤–ª–µ–Ω —Ñ–∏–ª—å—Ç—Ä `from_ts_sec`/`to_ts_sec` (–æ–∫–Ω–æ 10 –º–∏–Ω—É—Ç) –¥–ª—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏.

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç ‚úÖ
3. **decision_source:** `decision_source` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `bot_data` —á–µ—Ä–µ–∑ `NewTradingBot.to_dict()`.
4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω –ª–æ–≥ `[SYNC] –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∏—á–∏–Ω—É –∏–∑ bots_db: {effective_reason}` –ø—Ä–∏ –Ω–∞–π–¥–µ–Ω–Ω–æ–π –ø—Ä–∏—á–∏–Ω–µ.

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç ‚úÖ
5. **–ú–µ—Ç—Ä–∏–∫–∏:** –ú–µ—Ç—Ä–∏–∫–∏ `_sync_closes_total`, `_sync_closes_from_bots_db`; –¥–æ–ª—è –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ø—Ä–∏—á–∏–Ω—ã –∏–∑ bots_db.
6. **–¢–µ—Å—Ç—ã:** Unit-—Ç–µ—Å—Ç—ã –≤ `tests/test_analytics_recommendations.py` (virtual_only, _check_if_trade_already_closed, decision_source).

---

## 8. –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ –ª–æ–≥–∞–º –∏ –ë–î

- [ ] –í –ª–æ–≥–∞—Ö –ø—Ä–∏ FullAI: `ü§ñ AI —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –≤—Ö–æ–¥` –∏–ª–∏ `‚Üí –≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —Å–¥–µ–ª–∫–∞ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è`
- [ ] –ü—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏: –Ω–µ—Ç –¥—É–±–ª–µ–π –≤ `bot_trades_history` –ø–æ –æ–¥–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏ (symbol, entry_price, entry_time)
- [ ] –í fullai_events: real_close —Å close_source BOT_LIMIT_TP/SL/RSI_EXIT, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ CLOSED_ON_EXCHANGE
- [ ] –í self_learning_state: —Ä–∞—Å—Ç—É—Ç total_trades_processed –∏ buffer_size
- [ ] –ü—Ä–∏ virtual_only: –≤ –ª–æ–≥–∞—Ö `–≤–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è —Å–¥–µ–ª–∫–∞`, –≤ fullai_events ‚Äî virtual_open, –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –æ—Ä–¥–µ—Ä–∞ –Ω–∞ –±–∏—Ä–∂–µ
